# Mixed scenario (ADAPTIVE) - two concurrent jobs (TP-heavy + PP+DP)
# Run:
#   python ai_factory_network_simulation.py ai_factory_simulation/scenarios/ai_factory_su_mixed_scenario_adaptive.yaml
run:
  debug: false
  message_verbose: false
  verbose_route: false
  visualize: false
topology:
  type: ai-factory-su
  max_path: 64
  mtu: 4096
  ttl: 64
  routing:
    mode: adaptive
    ecmp_flowlet_n_packets: 512
  links:
    failure_percent: 0.0
    bandwidth_bps:
      server_to_leaf: 400e9
      leaf_to_spine: 400e9
scenario:
  name: ai-factory-su-mixed_scenario
  params:
    # General
    steps: 50
    seed: 2026
    traffic_scale: 0.25
    allocation_mode: rack_balanced
    stage_placement_mode: topology_aware
    # Job A (TP-heavy)
    jobA_fwd_compute_ms: 5.0
    jobA_micro_collectives: 16
    jobA_micro_collective_bytes_per_participant: 1048576
    jobA_micro_compute_gap_ms: 0.5
    jobA_final_sync_bytes_per_participant: 16777216
    jobA_tail_compute_ms: 2.0
    jobA_gap_us: 100.0
    # Job B (PP+DP)
    jobB_microbatch_count: 4
    jobB_microbatch_gap_us: 75.0
    jobB_activation_bytes_per_microbatch: 2097152
    jobB_grad_bytes_per_microbatch: 2097152
    jobB_dp_sync_bytes_per_participant: 33554432
    jobB_tail_compute_ms: 3.0
    record_first_step_flow_signatures: true
